package dto;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

public class EjemploManagement {

	private static final String JDBC_CLASS_NAME = "com.mysql.jdbc.Driver";
	private static final String MYSQL_CON = "jdbc:mysql://localhost:3306/ejemplo?characterEncoding=UTF-8";

	/**
	 * Realiza una consulta sobre la base de datos ejemplo y devuelve una lista con
	 * los empleados que tengan el cargo pasado por par√°metros
	 * 
	 * @param usuarioBd  el usuario de la base de datos
	 * @param passwordBd la password de la base de datos
	 * @param cargoEmp
	 * @return
	 */
	public static List<Empleado> getEmpleadoPorCargo(String usuarioBd, String passwordBd, String cargoEmp) {

		List<Empleado> listaEmpleados = new ArrayList<Empleado>();
		Connection con = null;

		String select = "SELECT * FROM empleados WHERE cargo = ?";

		try {

			Class.forName(JDBC_CLASS_NAME);

			con = DriverManager.getConnection(MYSQL_CON, usuarioBd, passwordBd);

			PreparedStatement sentencia = con.prepareStatement(select);
			sentencia.setString(1, cargoEmp);

			ResultSet resultado = sentencia.executeQuery();

			while (resultado.next()) {

				Empleado emp = new Empleado(resultado.getInt("id"), resultado.getString("nombre"),
						resultado.getString("apellido"), resultado.getString("cargo"), resultado.getDouble("salario"),
						resultado.getString("fecha_contratacion"), resultado.getInt("empresa_id"));

				listaEmpleados.add(emp);

			}

		} catch (ClassNotFoundException | SQLException e) {

			e.printStackTrace();

		} finally {

			closeConnection(con);

		}

		return listaEmpleados;
	}

	private static void closeConnection(Connection con) {

		try {

			con.close();

		} catch (SQLException e) {

			e.printStackTrace();

		}

	}

}
