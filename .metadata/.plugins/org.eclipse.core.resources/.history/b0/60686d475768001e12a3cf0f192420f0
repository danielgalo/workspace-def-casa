package main;

import java.io.File;
import java.security.Key;
import java.security.KeyStore;
import java.security.PublicKey;
import java.security.cert.Certificate;

import javax.crypto.Cipher;

public class CifraRSAApp {

	public static void main(String[] args) throws Exception {

		// Contraseña del fichero de claves
		String mensaje = args[0];

		// Contraseña del fichero de claves
		String password = args[1];

		// Alias del fichero
		String alias = "rsakeys";

		// Archivo de claves
		KeyStore almacen = KeyStore.getInstance(new File("rsakeys"), password.toCharArray());

		// Leer clave privada
		Key clavePrivada = almacen.getKey(alias, password.toCharArray());

		// Sacar el certificado para conseguir la clave pública
		Certificate certificado = almacen.getCertificate(alias);
		PublicKey clavePublica = certificado.getPublicKey();

		// Cifrar
		Cipher cifrado = Cipher.getInstance("RSA");
		cifrado.init(Cipher.ENCRYPT_MODE, clavePublica);

		// Cifrar el mensaje
		byte[] mensajeCifrado = cifrado.doFinal(mensaje.getBytes());
	}

}
